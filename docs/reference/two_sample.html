<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A two-sample test based on the DTS test statistic (dts_stat). This is the recommended two-sample test in this package because of its power. The DTS statistic is the reweighted integral of the distance between the two ECDFs."><title>DTS Test — dts_stat • twosamples</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="DTS Test — dts_stat"><meta property="og:description" content="A two-sample test based on the DTS test statistic (dts_stat). This is the recommended two-sample test in this package because of its power. The DTS statistic is the reweighted integral of the distance between the two ECDFs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">twosamples</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cdowd/twosamples/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>DTS Test</h1>
      <small class="dont-index">Source: <a href="https://github.com/cdowd/twosamples/blob/HEAD/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a>, <a href="https://github.com/cdowd/twosamples/blob/HEAD/R/documentation.R" class="external-link"><code>R/documentation.R</code></a>, <a href="https://github.com/cdowd/twosamples/blob/HEAD/R/two_samples.R" class="external-link"><code>R/two_samples.R</code></a></small>
      <div class="d-none name"><code>two_sample.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A two-sample test based on the DTS test statistic (<code>dts_stat</code>). This is the recommended two-sample test in this package because of its power. The DTS statistic is the reweighted integral of the distance between the two ECDFs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">dts_stat</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, power <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu">dts_test</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, nboots <span class="op">=</span> <span class="fl">2000</span>, p <span class="op">=</span> <span class="va">default.p</span><span class="op">)</span>

<span class="fu">two_sample</span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, nboots <span class="op">=</span> <span class="fl">2000</span>, p <span class="op">=</span> <span class="va">default.p</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>a</dt>
<dd><p>a vector of numbers (or factors -- see details)</p></dd>
<dt>b</dt>
<dd><p>a vector of numbers</p></dd>
<dt>power</dt>
<dd><p>also the power to raise the test stat to</p></dd>
<dt>nboots</dt>
<dd><p>Number of bootstrap iterations</p></dd>
<dt>p</dt>
<dd><p>power to raise test stat to</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Output is a length 2 Vector with test stat and p-value in that order. That vector has 3 attributes -- the sample sizes of each sample, and the number of bootstraps performed for the pvalue.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The DTS test compares two ECDFs by looking at the reweighted Wasserstein distance between the two. See the companion paper at <a href="https://arxiv.org/abs/2007.01360" class="external-link">arXiv:2007.01360</a> or <a href="https://codowd.com/public/DTS.pdf" class="external-link">https://codowd.com/public/DTS.pdf</a> for details of this test statistic, and non-standard uses of the package (parallel for big N, weighted observations, one sample tests, etc).</p>
<p>If the <code><a href="wass_test.html">wass_test()</a></code> extends <code><a href="cvm_test.html">cvm_test()</a></code> to interval data, then <code>dts_test()</code> extends <code><a href="ad_test.html">ad_test()</a></code> to interval data. Formally -- if E is the ECDF of sample 1, F is the ECDF of sample 2, and G is the ECDF of the combined sample, then $$DTS = \int_{x\in R} \left({|E(x)-F(x)| \over \sqrt{2G(x)(1-G(x))/n}}\right)^p$$ for all x.
The test p-value is calculated by randomly resampling two samples of the same size using the combined sample. Intuitively the DTS test improves on the AD test by allowing more extreme observations to carry more weight. At a higher level -- CVM/AD/KS/etc only require ordinal data. DTS (and Wasserstein) gain power because they take advantages of the properties of interval data -- i.e. the distances have some meaning. However, DTS, like Anderson-Darling (AD) also downweights noisier observations relative to Wass, thus (hopefully) giving it extra power.</p>
<p>In the example plot below, the DTS statistic is the shaded area between the ECDFs, weighted by the variances -- shown by the color of the shading.</p>
<p><img src="figures/dts.png" alt="Example Wasserstein stat plot"></p>
<p>Inputs <code>a</code> and <code>b</code> can also be vectors of ordered (or unordered) factors, so long as both have the same levels and orderings. When possible, ordering factors will substantially increase power. The dts test will assume the distance between adjacent factors is 1.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>dts_stat</code>: Test statistic based on a weighted area between ECDFs</p></li>
<li><p><code>dts_test</code>: Permutation based two sample test</p></li>
<li><p><code>two_sample</code>: Recommended two-sample test</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="wass_test.html">wass_test()</a></code>, <code><a href="ad_test.html">ad_test()</a></code> for the predecessors of this test statistic. <a href="https://arxiv.org/abs/2007.01360" class="external-link">arXiv:2007.01360</a> or <a href="https://codowd.com/public/DTS.pdf" class="external-link">https://codowd.com/public/DTS.pdf</a> for details of this test statistic</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">vec1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span class="r-in"><span class="va">vec2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">4</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">dts_stat</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39.91374</span>
<span class="r-in"><span class="fu">dts_test</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Stat   P-Value </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  39.91374   0.00025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"details")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      n1      n2 n.boots </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      20      20    2000 </span>
<span class="r-in"><span class="fu">two_sample</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Stat   P-Value </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  39.91374   0.00025 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"details")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      n1      n2 n.boots </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      20      20    2000 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Example using ordered factors</span></span>
<span class="r-in"><span class="va">vec1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>,levels <span class="op">=</span> <span class="va">LETTERS</span>,ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="va">vec2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span>,levels <span class="op">=</span> <span class="va">LETTERS</span>, ordered<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">dts_test</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test Stat   P-Value </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4.292354  0.484000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"details")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      n1      n2 n.boots </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       5       5    2000 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Connor Dowd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

