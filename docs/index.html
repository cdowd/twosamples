<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Fast randomization based two sample tests. 
  Testing the hypothesis that two samples come from the same distribution using randomization to create p-values. Included tests are: Kolmogorov-Smirnov, Kuiper, Cramer-von Mises, Anderson-Darling, Wasserstein, and DTS. The default test (two_sample) is based on the DTS test statistic, as it is the most powerful, and thus most useful to most users. 
  The DTS test statistic builds on the Wasserstein distance by using a weighting scheme like that of Anderson-Darling. See the companion paper at &lt;arXiv:2007.01360&gt; or &lt;https://codowd.com/public/DTS.pdf&gt; for details of that test statistic, and non-standard uses of the package (parallel for big N, weighted observations, one sample tests, etc). We also include the permutation scheme to make test building simple for others.">
<title>Fast Permutation Based Two Sample Tests • twosamples</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fast Permutation Based Two Sample Tests">
<meta property="og:description" content="Fast randomization based two sample tests. 
  Testing the hypothesis that two samples come from the same distribution using randomization to create p-values. Included tests are: Kolmogorov-Smirnov, Kuiper, Cramer-von Mises, Anderson-Darling, Wasserstein, and DTS. The default test (two_sample) is based on the DTS test statistic, as it is the most powerful, and thus most useful to most users. 
  The DTS test statistic builds on the Wasserstein distance by using a weighting scheme like that of Anderson-Darling. See the companion paper at &lt;arXiv:2007.01360&gt; or &lt;https://codowd.com/public/DTS.pdf&gt; for details of that test statistic, and non-standard uses of the package (parallel for big N, weighted observations, one sample tests, etc). We also include the permutation scheme to make test building simple for others.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">twosamples</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cdowd/twosamples/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="twosamples">twosamples<a class="anchor" aria-label="anchor" href="#twosamples"></a>
</h1></div>
<!-- badges: start -->


<!-- badges: end -->
<p>The goal of twosamples is to allow easy two-sample testing using permutations. This package offers quick (O(n^2) worst) and memory light (O(n)) code for a number of standard distance metrics between two samples. Using permutations of observed samples to calculate null distributions for those metrics, this package also provides assumption free p-values for the samples coming from the same distribution.</p>
<p>Details about the DTS statistic’s calculation, and performance can be found <a href="https://arxiv.org/abs/2007.01360" class="external-link">here.</a></p>
<p>Example R code which works to build test functions can be found on github <a href="https://github.com/cdowd/twosamples/blob/main/R/Extras/test_stats_R.R" class="external-link">here.</a> This code uses the release v1.0.0 algorithm for simplicity, and is in R rather than C++, so is substantially slower.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of twosamples from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"twosamples"</span><span class="op">)</span></span></code></pre></div>
<p>Or you can install the most recent (possibly unstable) version from github:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"cdowd/twosamples"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="system-requirements">System Requirements<a class="anchor" aria-label="anchor" href="#system-requirements"></a>
</h4>
<p>Going forward (v2.0.0 onwards), <code>twosamples</code> depends on having C++11 installed. This is true of most R platforms and available for all of them. Compilation also requires headers from the <code>cpp11</code> package.</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this example, we have 100 observations from two different Normal distributions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://twosampletest.com">twosamples</a></span><span class="op">)</span></span>
<span><span class="va">vec1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">vec2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">output</span> <span class="op">=</span> <span class="fu"><a href="reference/two_sample.html">two_sample</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span><span class="va">output</span></span>
<span><span class="co">#&gt; Test Stat   P-Value </span></span>
<span><span class="co">#&gt;  11.33121   0.01500</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span>
<span><span class="co">#&gt; DTS Test </span></span>
<span><span class="co">#&gt; =========================</span></span>
<span><span class="co">#&gt; Test Statistic: 11.33121 </span></span>
<span><span class="co">#&gt;        P-Value: 0.015 *</span></span>
<span><span class="co">#&gt; - - - - - - - - - - - - -</span></span>
<span><span class="co">#&gt;      n1      n2 n.boots </span></span>
<span><span class="co">#&gt;     100     100    2000 </span></span>
<span><span class="co">#&gt; =========================</span></span>
<span><span class="co">#&gt; Test stat rejection threshold for alpha = 0.05 is: 9.949129 </span></span>
<span><span class="co">#&gt; Null rejected: samples are from different distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/example1-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="metric-example-calculations">Metric Example Calculations<a class="anchor" aria-label="anchor" href="#metric-example-calculations"></a>
</h2>
<p>This section will review each of the different tests offered. I’ll offer a brief description of the test mathematically, then some quick intuition. After that, I’ll show R code that would build the test statistic – to provide a full description. That code is not the code underlying this package, but a C++ rewrite of it is.</p>
<p>Each of these test statistics looks at the ECDFs which samples correspond to. I’ll refer to E(x) as the ECDF of sample 1, F(x) as the ECDF of sample 2, and G(x) as the ECDF of the joint sample. The ECDF of course takes a real input and returns a value corresponding to the portion of the sample which was observed less than or equal to that point.</p>
<div class="section level3">
<h3 id="kolmogorov-smirnov-test">Kolmogorov-Smirnov Test<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov-test"></a>
</h3>
<p>The KS test finds the largest (vertical) difference between the two ECDFs. See <code><a href="reference/ks_test.html">ks_test()</a></code>.</p>
<details><summary>
Demonstration R Code Calculating Test Statistic
</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ks_stat_R</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span>,<span class="va">power</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span></span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span></span>
<span>  </span>
<span>  <span class="va">joint.sample</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n2</span>,<span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">joint.sample</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="va">joint.sample</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="va">e</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="va">f</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Ecur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Fcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">height</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ecur</span> <span class="op">=</span> <span class="va">Ecur</span> <span class="op">+</span> <span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Fcur</span> <span class="op">=</span> <span class="va">Fcur</span> <span class="op">+</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">!=</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="va">height</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Fcur</span><span class="op">-</span><span class="va">Ecur</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">height</span> <span class="op">&gt;</span> <span class="va">out</span><span class="op">)</span> <span class="va">out</span> <span class="op">=</span> <span class="va">height</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span><span class="op">^</span><span class="va">power</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>In the example plot below, the KS statistic is the height of the vertical black line.</p>
<p><img src="reference/figures/ks.png" title="Example KS stat plot"></p>
</div>
<div class="section level3">
<h3 id="kuiper-test">Kuiper Test<a class="anchor" aria-label="anchor" href="#kuiper-test"></a>
</h3>
<p>The Kuiper test is much the same as Kolmogorov-Smirnov, but it sums the largest difference in each direction. i.e. it cares about the difference between E(x)-F(x) and F(x)-E(x). In some sense this should be trading some power against mean-shifts for power against variance changes. See <code><a href="reference/kuiper_test.html">kuiper_test()</a></code></p>
<details><summary>
Demonstration R Code Calculating Test Statistic
</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kuiper_stat_R</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span>,<span class="va">power</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span> </span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span></span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span></span>
<span>  </span>
<span>  <span class="va">joint.sample</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n2</span>,<span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">joint.sample</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="va">joint.sample</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="va">e</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="va">f</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">up</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">down</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Ecur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Fcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">height</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ecur</span> <span class="op">=</span> <span class="va">Ecur</span> <span class="op">+</span> <span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Fcur</span> <span class="op">=</span> <span class="va">Fcur</span> <span class="op">+</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">!=</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="va">height</span> <span class="op">=</span> <span class="va">Fcur</span><span class="op">-</span><span class="va">Ecur</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">height</span> <span class="op">&gt;</span> <span class="va">up</span><span class="op">)</span> <span class="va">up</span> <span class="op">=</span> <span class="va">height</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">height</span> <span class="op">&lt;</span> <span class="va">down</span><span class="op">)</span> <span class="va">down</span> <span class="op">=</span> <span class="va">height</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">down</span><span class="op">)</span><span class="op">^</span><span class="va">power</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">up</span><span class="op">)</span><span class="op">^</span><span class="va">power</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>In the example plot below, the Kuiper statistic is the sum of the heights of the vertical black lines.</p>
<p><img src="reference/figures/kuiper.png" title="Example Kuiper stat plot"></p>
</div>
<div class="section level3">
<h3 id="cramer-von-mises">Cramer-Von Mises<a class="anchor" aria-label="anchor" href="#cramer-von-mises"></a>
</h3>
<p>The Cramer-Von Mises criterion further extends the intuition of Kuiper and KS. It is actually the full sum across every observation X of the difference |F(x)-E(x)|. This use of the full joint sample gives it a substantial power gain, particularly against higher moments shifting. See <code><a href="reference/cvm_test.html">cvm_test()</a></code>.</p>
<details><summary>
Demonstration R Code Calculating Test Statistic
</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cvm_stat_R</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span>,<span class="va">power</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span></span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span></span>
<span>  </span>
<span>  <span class="va">joint.sample</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n2</span>,<span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">joint.sample</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="va">joint.sample</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="va">e</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="va">f</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Ecur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Fcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">height</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">dups</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ecur</span> <span class="op">=</span> <span class="va">Ecur</span> <span class="op">+</span> <span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Fcur</span> <span class="op">=</span> <span class="va">Fcur</span> <span class="op">+</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">height</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Fcur</span><span class="op">-</span><span class="va">Ecur</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">!=</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">out</span> <span class="op">=</span> <span class="va">out</span> <span class="op">+</span> <span class="op">(</span><span class="va">height</span><span class="op">^</span><span class="va">power</span><span class="op">)</span><span class="op">*</span><span class="va">dups</span></span>
<span>      <span class="va">dups</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">dups</span> <span class="op">=</span> <span class="va">dups</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>In the example plot below, the CVM statistic is the sum of the heights of the vertical black lines.</p>
<p><img src="reference/figures/cvm.png" title="Example CVM stat plot"></p>
</div>
<div class="section level3">
<h3 id="anderson-darling">Anderson-Darling<a class="anchor" aria-label="anchor" href="#anderson-darling"></a>
</h3>
<p>Anderson-Darling test starts from the Cramer-Von Mises logic. However, they note that some points on the joint ECDF are higher variance than others. Because there is more noise in those observations, they should receive a lower weight. More than that, we can even describe the ‘optimal’ weighting function – it is closely related to the joint ECDF - G. See <code><a href="reference/ad_test.html">ad_test()</a></code></p>
<details><summary>
Demonstration R Code Calculating Test Statistic
</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ad_stat_R</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span>,<span class="va">power</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span></span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span></span>
<span>  </span>
<span>  <span class="va">joint.sample</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n2</span>,<span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">joint.sample</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="va">joint.sample</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="va">e</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="va">f</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Ecur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Fcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Gcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">height</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">dups</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>  </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ecur</span> <span class="op">=</span> <span class="va">Ecur</span> <span class="op">+</span> <span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Fcur</span> <span class="op">=</span> <span class="va">Fcur</span> <span class="op">+</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Gcur</span> <span class="op">=</span> <span class="va">Gcur</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span></span>
<span>    <span class="va">sd</span> <span class="op">=</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">Gcur</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">Gcur</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">**</span><span class="fl">0.5</span></span>
<span>    <span class="va">height</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Fcur</span><span class="op">-</span><span class="va">Ecur</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">!=</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">out</span> <span class="op">=</span> <span class="va">out</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">height</span><span class="op">/</span><span class="va">sd</span><span class="op">)</span><span class="op">^</span><span class="va">power</span><span class="op">)</span><span class="op">*</span><span class="va">dups</span></span>
<span>      <span class="va">dups</span> <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">dups</span> <span class="op">=</span> <span class="va">dups</span><span class="op">+</span><span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>In the example plot below, we see the variance of the joint ECDF over the range of the data. It clearly peaks in the middle of the joint sample.</p>
<p><img src="reference/figures/var.png" title="Plot of Variance of joint ECDF"></p>
<p>In the example plot below, the AD statistic is the weighted sum of the heights of the vertical lines, where weights are represented by the shading of the lines.</p>
<p><img src="reference/figures/ad.png" title="Example AD stat plot"></p>
</div>
<div class="section level3">
<h3 id="wasserstein">Wasserstein<a class="anchor" aria-label="anchor" href="#wasserstein"></a>
</h3>
<p>The Wasserstein distance is not normally a two-sample distance, but the extension is very simple. In terms of the ECDFs it can actually be described as the area between the ECDFs. Intuitively, the improvement this offers over CVM is that it allows more extreme values to change our conclusions. That is to say – KS, Kuiper, CVM, and AD have all operated on ordinal variables, with no sense of the distance between different rank order observations. Wasserstein (and below DTS) will require interval data. By utilizing the extra information encoded when information is from interval data, Wasserstein and DTS will improve on CVM and AD. See <code><a href="reference/wass_test.html">wass_test()</a></code></p>
<details><summary>
Demonstration R Code Calculating Test Statistic
</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wass_stat_R</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span>,<span class="va">power</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span></span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span></span>
<span>  </span>
<span>  <span class="va">joint.sample</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n2</span>,<span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">joint.sample</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="va">joint.sample</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="va">e</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="va">f</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Ecur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Fcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">height</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">width</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ecur</span> <span class="op">=</span> <span class="va">Ecur</span> <span class="op">+</span> <span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Fcur</span> <span class="op">=</span> <span class="va">Fcur</span> <span class="op">+</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">height</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Fcur</span><span class="op">-</span><span class="va">Ecur</span><span class="op">)</span></span>
<span>    <span class="va">width</span> <span class="op">=</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">out</span> <span class="op">=</span> <span class="va">out</span> <span class="op">+</span> <span class="op">(</span><span class="va">height</span><span class="op">^</span><span class="va">power</span><span class="op">)</span><span class="op">*</span><span class="va">width</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>In the example plot below, the Wasserstein statistic is the shaded area between the ECDFs.</p>
<p><img src="reference/figures/wass.png" title="Example Wasserstein stat plot"></p>
</div>
<div class="section level3">
<h3 id="dtstwo_sample">DTS/two_sample<a class="anchor" aria-label="anchor" href="#dtstwo_sample"></a>
</h3>
<p>If the Wasserstein metric improves on CVM by moving it into the realm of interval data, then DTS improves on AD by doing the same. Alternately – DTS offers the same improvement over Wasserstein that AD offers over CVM. See <code><a href="reference/two_sample.html">dts_test()</a></code> (AKA <code><a href="reference/two_sample.html">two_sample()</a></code> ).</p>
<details><summary>
Demonstration R Code Calculating Test Statistic
</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dts_stat_R</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span>,<span class="va">power</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec1</span><span class="op">)</span></span>
<span>  <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span></span>
<span>  </span>
<span>  <span class="va">joint.sample</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vec1</span>,<span class="va">vec2</span><span class="op">)</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n1</span>,<span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">n1</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n2</span>,<span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ind</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">joint.sample</span><span class="op">)</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="va">joint.sample</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">e</span> <span class="op">=</span> <span class="va">e</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="va">f</span><span class="op">[</span><span class="va">ind</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Ecur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Fcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">Gcur</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">height</span> <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="va">width</span> <span class="op">=</span> <span class="fl">0</span> </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Ecur</span> <span class="op">=</span> <span class="va">Ecur</span> <span class="op">+</span> <span class="va">e</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Fcur</span> <span class="op">=</span> <span class="va">Fcur</span> <span class="op">+</span> <span class="va">f</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">Gcur</span> <span class="op">=</span> <span class="va">Gcur</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span></span>
<span>    <span class="va">sd</span> <span class="op">=</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">Gcur</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">Gcur</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">)</span><span class="op">**</span><span class="fl">0.5</span></span>
<span>    <span class="va">height</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">Fcur</span><span class="op">-</span><span class="va">Ecur</span><span class="op">)</span></span>
<span>    <span class="va">width</span> <span class="op">=</span> <span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">d</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>    <span class="va">out</span> <span class="op">=</span> <span class="va">out</span> <span class="op">+</span> <span class="op">(</span><span class="op">(</span><span class="va">height</span><span class="op">/</span><span class="va">sd</span><span class="op">)</span><span class="op">^</span><span class="va">power</span><span class="op">)</span><span class="op">*</span><span class="va">width</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">out</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details><p>In the example plot below, the DTS statistic is the shaded area between the ECDFs, weighted by the variances – shown by the color of the shading.</p>
<p><img src="reference/figures/dts.png" title="Example Wasserstein stat plot"></p>
</div>
</div>
<div class="section level2">
<h2 id="permutation-testing">Permutation Testing<a class="anchor" aria-label="anchor" href="#permutation-testing"></a>
</h2>
<p>Once we have a metric measuring distance between two samples, its easy enough to code up a testing procedure.</p>
<p>Specifically we want to test the following: * H0: J=K</p>
<p>where Sample 1 is distributed i.i.d. from J and Sample 2 is i.i.d. from K.</p>
<p>Broadly, under this null, observations from sample 1 and sample 2 are exchangeable.That is – by randomly swapping observations between the samples, we can generate a new, equally likely data set from the same (Null) DGP. Then we can calculate our metric for distance between the samples on this data set. By repeating this procedure many times, we can generate a null distribution for our distance metric. We can then compare our observed distance to the null distribution. Because distances are non-negative, this will be a one-sided comparison. (Though if you wanted to test whether a sample was hyper-regular you could do that by looking at the one-sided test to the bottom).</p>
<p>Moreover, unlike other, more general, two-sample procedures we do not rely on any properties of the underlying distribution. Some procedures require continuity, derivatives, or smoothness to get their asymptotic and finite sample guarantees. Those are procedures which estimate the underlying density, rather than simply working working the ECDF. The testing procedures in this package only rely on the statement that observations are i.i.d. The Independence is necessary for the exchangeability statement to hold. The identicality is necessary for the null hypothesis to be a sensible claim.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=twosamples" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/cdowd/twosamples/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cdowd/twosamples/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing twosamples</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://codowd.com" class="external-link">Connor Dowd</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9782-0931" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cdowd/twosamples/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/cdowd/twosamples/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://github.com/cdowd/twosamples/actions/workflows/pages/pages-build-deployment" class="external-link"><img src="https://github.com/cdowd/twosamples/actions/workflows/pages/pages-build-deployment/badge.svg?branch=main" alt="pages-build-deployment"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://codowd.com" class="external-link">Connor Dowd</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
